DROP TABLE IF EXISTS GROUPS CASCADE;
DROP TABLE IF EXISTS STUDENTS CASCADE;
DROP TABLE IF EXISTS COURSES CASCADE;
DROP TABLE IF EXISTS STUDENTS_COURSES CASCADE;


CREATE TABLE GROUPS
(
    group_id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    group_name character varying(255) NOT NULL,
    CONSTRAINT GROUPS_pkey PRIMARY KEY (group_id)
);


CREATE TABLE STUDENTS
(
    student_id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    group_id integer NULL,
    first_name character varying(255) NOT NULL,
    last_name character varying(255) NOT NULL,
    CONSTRAINT STUDENTS_pkey PRIMARY KEY (student_id),
    CONSTRAINT STUDENTS_fkey FOREIGN KEY (group_id) REFERENCES GROUPS(group_id) ON DELETE RESTRICT
);


CREATE TABLE COURSES
(
    course_id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    course_name character varying(255) NOT NULL,
    course_description character varying(255) NOT NULL,
    CONSTRAINT COURSES_pkey PRIMARY KEY (course_id)
);

CREATE TABLE STUDENTS_COURSES
(
    student_id integer NOT NULL,
    course_id integer NOT NULL,
    CONSTRAINT STUDENTS_COURSES_pkey PRIMARY KEY (student_id, course_id),
    CONSTRAINT STUDENTS_COURSES_fkey1 FOREIGN KEY (student_id) REFERENCES STUDENTS(student_id) ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT STUDENTS_COURSES_fkey2 FOREIGN KEY (course_id) REFERENCES COURSES(course_id) ON DELETE CASCADE ON UPDATE CASCADE
);